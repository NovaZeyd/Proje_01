<!DOCTYPE html>
<html lang="az">
<head>
<meta charset="UTF-8">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>MÃ¼hasibatlÄ±q Veb Paneli</title>
<script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.0/dist/chart.umd.min.js"></script>
<script src="https://cdn.jsdelivr.net/npm/xlsx@0.18.5/dist/xlsx.full.min.js"></script>
<style>
:root{
  --bg:#0d0f1a;--sidebar:#111827;--card:#1a1f2e;--card2:#222840;
  --accent:#6366f1;--accent2:#10b981;--red:#ef4444;--yellow:#f59e0b;
  --text:#e2e8f0;--muted:#64748b;--border:#1e2a3a;
  --sidebar-w:240px;
}
*{box-sizing:border-box;margin:0;padding:0}
body{background:var(--bg);color:var(--text);font-family:'Segoe UI',system-ui,sans-serif;display:flex;min-height:100vh;overflow-x:hidden}

/* â”€â”€ SIDEBAR â”€â”€ */
.sidebar{width:var(--sidebar-w);background:var(--sidebar);border-right:1px solid var(--border);display:flex;flex-direction:column;position:fixed;top:0;left:0;bottom:0;z-index:200;transition:width .25s}
.sidebar.collapsed{width:60px}
.sidebar-head{padding:16px;display:flex;align-items:center;gap:10px;border-bottom:1px solid var(--border);min-height:60px}
.sidebar-head .logo{font-size:1.3rem;flex-shrink:0}
.sidebar-head h1{font-size:.9rem;font-weight:700;white-space:nowrap;overflow:hidden;opacity:1;transition:opacity .2s}
.sidebar.collapsed .sidebar-head h1{opacity:0;width:0}
.hamburger{margin-left:auto;background:none;border:none;color:var(--muted);cursor:pointer;font-size:1.1rem;flex-shrink:0;padding:4px}
.hamburger:hover{color:var(--text)}
.nav-section{padding:8px 0}
.nav-label{padding:6px 16px;font-size:.65rem;font-weight:700;color:var(--muted);text-transform:uppercase;letter-spacing:1.5px;white-space:nowrap;overflow:hidden}
.sidebar.collapsed .nav-label{opacity:0}
.nav-item{display:flex;align-items:center;gap:10px;padding:10px 16px;cursor:pointer;border-left:3px solid transparent;transition:all .15s;text-decoration:none;color:var(--muted);white-space:nowrap}
.nav-item:hover{background:rgba(99,102,241,.08);color:var(--text)}
.nav-item.active{background:rgba(99,102,241,.12);color:var(--accent);border-left-color:var(--accent)}
.nav-item .icon{font-size:1rem;flex-shrink:0;width:20px;text-align:center}
.nav-item .label{font-size:.82rem;font-weight:500;opacity:1;transition:opacity .2s}
.sidebar.collapsed .nav-item .label{opacity:0;width:0;overflow:hidden}
.nav-badge{margin-left:auto;background:var(--red);color:#fff;border-radius:20px;font-size:.65rem;padding:1px 6px;font-weight:700}

/* â”€â”€ MAIN â”€â”€ */
.main{margin-left:var(--sidebar-w);flex:1;display:flex;flex-direction:column;min-height:100vh;transition:margin-left .25s}
.sidebar.collapsed~.main{margin-left:60px}
.topbar{height:60px;background:var(--sidebar);border-bottom:1px solid var(--border);display:flex;align-items:center;padding:0 24px;gap:16px;position:sticky;top:0;z-index:100}
.topbar-title{font-size:1rem;font-weight:700}
.topbar-right{margin-left:auto;display:flex;align-items:center;gap:12px}
.search-box{background:var(--card2);border:1px solid var(--border);color:var(--text);padding:7px 14px;border-radius:8px;font-size:.8rem;width:220px}
.search-box:focus{outline:none;border-color:var(--accent)}
.avatar{width:34px;height:34px;border-radius:50%;background:linear-gradient(135deg,var(--accent),#8b5cf6);display:flex;align-items:center;justify-content:center;font-size:.75rem;font-weight:700;cursor:pointer}
.content{padding:24px;flex:1}
.page{display:none}
.page.active{display:block}

/* â”€â”€ CARDS â”€â”€ */
.kpi-row{display:grid;grid-template-columns:repeat(auto-fit,minmax(180px,1fr));gap:16px;margin-bottom:24px}
.kpi{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:18px;position:relative;overflow:hidden}
.kpi::after{content:'';position:absolute;top:0;left:0;right:0;height:3px;background:var(--accent)}
.kpi.green::after{background:var(--accent2)}
.kpi.red::after{background:var(--red)}
.kpi.yellow::after{background:var(--yellow)}
.kpi-lbl{font-size:.7rem;color:var(--muted);margin-bottom:6px;text-transform:uppercase;letter-spacing:.5px}
.kpi-val{font-size:1.6rem;font-weight:800}
.kpi-sub{font-size:.7rem;color:var(--muted);margin-top:4px}
.kpi.green .kpi-val{color:var(--accent2)}
.kpi.red .kpi-val{color:var(--red)}
.kpi.yellow .kpi-val{color:var(--yellow)}

/* â”€â”€ GRID â”€â”€ */
.grid2{display:grid;grid-template-columns:1fr 1fr;gap:20px}
.grid3{display:grid;grid-template-columns:1fr 1fr 1fr;gap:16px}
@media(max-width:900px){.grid2,.grid3{grid-template-columns:1fr}}

/* â”€â”€ TABLE â”€â”€ */
.card{background:var(--card);border:1px solid var(--border);border-radius:12px;padding:20px;margin-bottom:20px}
.card-head{display:flex;align-items:center;gap:10px;margin-bottom:16px}
.card-head h3{font-size:.875rem;font-weight:700}
.card-head .muted{font-size:.75rem;color:var(--muted);margin-left:auto}
.tbl-wrap{overflow-x:auto}
table{width:100%;border-collapse:collapse;font-size:.8rem}
th{background:var(--card2);padding:10px 14px;text-align:left;color:var(--muted);font-weight:600;white-space:nowrap;border-bottom:1px solid var(--border)}
td{padding:10px 14px;border-bottom:1px solid rgba(30,42,58,.6);vertical-align:middle}
tr:last-child td{border-bottom:none}
tr:hover td{background:rgba(99,102,241,.05);cursor:pointer}
.num{text-align:right;font-variant-numeric:tabular-nums}

/* â”€â”€ BADGES â”€â”€ */
.badge{display:inline-flex;align-items:center;gap:4px;padding:3px 10px;border-radius:20px;font-size:.68rem;font-weight:600}
.badge.ok{background:rgba(16,185,129,.12);color:var(--accent2)}
.badge.warn{background:rgba(245,158,11,.12);color:var(--yellow)}
.badge.err{background:rgba(239,68,68,.12);color:var(--red)}
.badge.info{background:rgba(99,102,241,.12);color:var(--accent)}
.dot{width:7px;height:7px;border-radius:50%;display:inline-block}
.dot.ok{background:var(--accent2)}
.dot.warn{background:var(--yellow)}
.dot.err{background:var(--red)}

/* â”€â”€ SECTION TITLE â”€â”€ */
.sec-title{font-size:.68rem;font-weight:700;color:var(--accent);text-transform:uppercase;letter-spacing:1.5px;margin:24px 0 12px}
.sec-title:first-child{margin-top:0}

/* â”€â”€ QUICK LINKS â”€â”€ */
.ql-row{display:flex;gap:10px;flex-wrap:wrap;margin-bottom:20px}
.ql{background:var(--card);border:1px solid var(--border);border-radius:10px;padding:10px 16px;font-size:.78rem;cursor:pointer;display:flex;align-items:center;gap:8px;transition:all .15s}
.ql:hover{background:var(--card2);border-color:var(--accent)}

/* â”€â”€ ALERT â”€â”€ */
.alert{padding:12px 16px;border-radius:8px;font-size:.8rem;line-height:1.6;margin-bottom:12px;border-left:4px solid}
.alert.info{background:rgba(99,102,241,.08);border-color:var(--accent)}
.alert.ok{background:rgba(16,185,129,.08);border-color:var(--accent2)}
.alert.warn{background:rgba(245,158,11,.08);border-color:var(--yellow)}
.alert.err{background:rgba(239,68,68,.08);border-color:var(--red)}

/* â”€â”€ COMPANY CARD â”€â”€ */
.company-card{display:none}
.company-card.active{display:block}
.back-btn{background:none;border:1px solid var(--border);color:var(--muted);padding:7px 16px;border-radius:8px;font-size:.8rem;cursor:pointer;margin-bottom:20px;display:flex;align-items:center;gap:6px}
.back-btn:hover{color:var(--text);border-color:var(--accent)}
.company-header{background:linear-gradient(135deg,var(--card),var(--card2));border:1px solid var(--border);border-radius:14px;padding:24px;margin-bottom:20px;display:flex;gap:20px;align-items:center}
.company-avatar{width:56px;height:56px;border-radius:12px;background:linear-gradient(135deg,var(--accent),#8b5cf6);display:flex;align-items:center;justify-content:center;font-size:1.4rem;flex-shrink:0}
.company-header h2{font-size:1.1rem;font-weight:800}
.company-header p{font-size:.78rem;color:var(--muted);margin-top:3px}
.info-grid{display:grid;grid-template-columns:1fr 1fr;gap:10px}
.info-item{background:var(--card2);border-radius:8px;padding:10px 14px}
.info-item .key{font-size:.68rem;color:var(--muted);margin-bottom:3px}
.info-item .val{font-size:.85rem;font-weight:600}
.muk-item{display:flex;align-items:center;gap:12px;padding:10px;background:var(--card2);border-radius:8px;margin-bottom:8px;font-size:.82rem}
.muk-icon{font-size:1rem;width:28px;text-align:center}
.report-row{display:flex;align-items:center;gap:12px;padding:10px 14px;border-bottom:1px solid var(--border)}
.report-row:last-child{border-bottom:none}
.report-name{flex:1;font-size:.82rem}
.report-deadline{font-size:.75rem;color:var(--muted);width:100px}
.report-action{font-size:.75rem;color:var(--accent);cursor:pointer;padding:4px 10px;border:1px solid var(--accent);border-radius:6px}
.report-action:hover{background:var(--accent);color:#fff}

/* â”€â”€ IMPORT â”€â”€ */
.drop-zone{border:2px dashed var(--border);border-radius:12px;padding:40px;text-align:center;cursor:pointer;transition:all .2s}
.drop-zone:hover,.drop-zone.drag{border-color:var(--accent);background:rgba(99,102,241,.05)}
.drop-zone p{color:var(--muted);font-size:.85rem;margin-top:8px}
.file-list{margin-top:16px}
.file-item{display:flex;align-items:center;gap:12px;padding:10px 14px;background:var(--card2);border-radius:8px;margin-bottom:8px;font-size:.8rem}
.file-item .fi-icon{font-size:1.2rem}
.file-item .fi-name{flex:1}
.fi-status{font-size:.7rem;padding:2px 8px;border-radius:20px}

/* â”€â”€ TABS â”€â”€ */
.tabs{display:flex;gap:4px;margin-bottom:16px;background:var(--card2);padding:4px;border-radius:10px;width:fit-content}
.tab-btn{padding:7px 18px;border-radius:7px;font-size:.8rem;cursor:pointer;border:none;background:none;color:var(--muted);transition:all .15s}
.tab-btn.active{background:var(--accent);color:#fff}
.tab-pane{display:none}
.tab-pane.active{display:block}

/* â”€â”€ VAT FLOW â”€â”€ */
.vat-flow{display:flex;align-items:center;background:var(--card2);border-radius:12px;overflow:hidden;border:1px solid var(--border);margin-bottom:16px}
.vf-box{flex:1;padding:20px;text-align:center}
.vf-box:not(:last-child){border-right:1px solid var(--border)}
.vf-lbl{font-size:.65rem;color:var(--muted);text-transform:uppercase;letter-spacing:.8px;margin-bottom:6px}
.vf-val{font-size:1.2rem;font-weight:800}
.vf-box.out .vf-val{color:var(--red)}
.vf-box.inn .vf-val{color:var(--accent2)}
.vf-box.res .vf-val{color:var(--yellow)}
.vf-op{padding:0 10px;color:var(--muted);font-size:1.3rem}

/* â”€â”€ PROGRESS BAR â”€â”€ */
.prog-row{display:flex;align-items:center;gap:10px;margin-bottom:10px}
.prog-lbl{font-size:.75rem;flex:1}
.prog-bar-wrap{flex:2;background:var(--card2);border-radius:4px;height:6px}
.prog-bar{height:100%;border-radius:4px;background:var(--accent)}
.prog-val{font-size:.75rem;color:var(--muted);min-width:70px;text-align:right}

/* â”€â”€ CHART â”€â”€ */
.chart-wrap{position:relative;height:200px}

/* â”€â”€ MODAL â”€â”€ */
.modal-overlay{display:none;position:fixed;inset:0;background:rgba(0,0,0,.6);z-index:500;align-items:center;justify-content:center}
.modal-overlay.show{display:flex}
.modal{background:var(--card);border:1px solid var(--border);border-radius:14px;padding:28px;max-width:520px;width:90%;max-height:80vh;overflow-y:auto}
.modal h3{font-size:1rem;font-weight:700;margin-bottom:16px}
.modal-close{float:right;background:none;border:none;color:var(--muted);cursor:pointer;font-size:1.2rem}

/* â”€â”€ BUTTONS â”€â”€ */
.btn{padding:8px 18px;border-radius:8px;font-size:.82rem;cursor:pointer;border:none;font-weight:600;transition:all .15s}
.btn.primary{background:var(--accent);color:#fff}
.btn.primary:hover{background:#4f46e5}
.btn.ghost{background:none;border:1px solid var(--border);color:var(--muted)}
.btn.ghost:hover{border-color:var(--accent);color:var(--text)}
.btn.success{background:var(--accent2);color:#fff}

/* â”€â”€ SCROLL â”€â”€ */
::-webkit-scrollbar{width:6px;height:6px}
::-webkit-scrollbar-track{background:transparent}
::-webkit-scrollbar-thumb{background:var(--border);border-radius:3px}
</style>
</head>
<body>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• SIDEBAR â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<nav class="sidebar" id="sidebar">
  <div class="sidebar-head">
    <span class="logo">ğŸ“Š</span>
    <h1>MÃ¼hPaneli</h1>
    <button class="hamburger" onclick="toggleSidebar()">â˜°</button>
  </div>

  <div class="nav-section">
    <div class="nav-label">Æsas</div>
    <a class="nav-item active" onclick="navigate('dashboard')" href="#">
      <span class="icon">ğŸ </span><span class="label">Dashboard</span>
    </a>
    <a class="nav-item" onclick="navigate('companies')" href="#">
      <span class="icon">ğŸ¢</span><span class="label">ÅirkÉ™tlÉ™r</span>
    </a>
  </div>

  <div class="nav-section">
    <div class="nav-label">Hesabatlar</div>
    <a class="nav-item" onclick="navigate('edv')" href="#">
      <span class="icon">ğŸ“‹</span><span class="label">ÆDV HesabatÄ±</span>
      <span class="nav-badge">!</span>
    </a>
    <a class="nav-item" onclick="navigate('reports')" href="#">
      <span class="icon">ğŸ“</span><span class="label">DigÉ™r Hesabatlar</span>
    </a>
  </div>

  <div class="nav-section">
    <div class="nav-label">Ä°dxal / Ã‡Ä±xÄ±ÅŸ</div>
    <a class="nav-item" onclick="navigate('import')" href="#">
      <span class="icon">ğŸ“¥</span><span class="label">Ä°dxal (Excel)</span>
    </a>
    <a class="nav-item" onclick="navigate('bank')" href="#">
      <span class="icon">ğŸ¦</span><span class="label">Bank DÃ¶vriyyÉ™si</span>
    </a>
  </div>

  <div class="nav-section">
    <div class="nav-label">Qaynaqlar</div>
    <a class="nav-item" href="avazlesme.html" target="_blank">
      <span class="icon">ğŸ”„</span><span class="label">ÆvÉ™zlÉ™ÅŸmÉ™ Sistemi</span>
    </a>
    <a class="nav-item" href="qanunlar.html" target="_blank">
      <span class="icon">âš–ï¸</span><span class="label">Vergi QanunlarÄ±</span>
    </a>
  </div>
</nav>

<!-- â•â•â•â•â•â•â•â•â•â•â•â•â•â• MAIN â•â•â•â•â•â•â•â•â•â•â•â•â•â• -->
<div class="main">
  <div class="topbar">
    <div class="topbar-title" id="page-title">Dashboard</div>
    <div class="topbar-right">
      <input class="search-box" type="text" placeholder="ğŸ” ÅirkÉ™t axtar..." oninput="searchCompany(this.value)">
      <div class="avatar" title="Admin">A</div>
    </div>
  </div>

  <div class="content">

    <!-- â•â• DASHBOARD â•â• -->
    <div class="page active" id="page-dashboard">
      <div class="kpi-row">
        <div class="kpi red">
          <div class="kpi-lbl">CÉ™mi Vergi Borcu</div>
          <div class="kpi-val">13,567 â‚¼</div>
          <div class="kpi-sub">3V MMC â€” ÆDV Dek 2025</div>
        </div>
        <div class="kpi yellow">
          <div class="kpi-lbl">VerilmÉ™miÅŸ Hesabat</div>
          <div class="kpi-val">2</div>
          <div class="kpi-sub">Son tarix yaxÄ±nlaÅŸÄ±r</div>
        </div>
        <div class="kpi green">
          <div class="kpi-lbl">Aktiv ÅirkÉ™t</div>
          <div class="kpi-val">1</div>
          <div class="kpi-sub">3V MMC izlÉ™nilir</div>
        </div>
        <div class="kpi">
          <div class="kpi-lbl">Bank DÃ¶vriyyÉ™si</div>
          <div class="kpi-val">893 K â‚¼</div>
          <div class="kpi-sub">Dek 2025 â€“ Yan 2026 cÉ™mi</div>
        </div>
      </div>

      <!-- Son tarixlÉ™r -->
      <div class="alert warn">â° <strong>XÉ™bÉ™rdarlÄ±q:</strong> Fevral 2026 ÆDV bÉ™yannamÉ™sinin son tarixi â€” 20 Mart 2026. HazÄ±rlanma baÅŸlanmalÄ±dÄ±r.</div>
      <div class="alert err">ğŸš¨ <strong>DiqqÉ™t:</strong> Vahid MÃ¼zdlu Hesabat (Yanvar 2026) â€” son tarix: 20 Fevral 2026. Status: VerilmÉ™yib.</div>

      <!-- Tez keÃ§id -->
      <div class="sec-title">Tez KeÃ§id</div>
      <div class="ql-row">
        <div class="ql" onclick="navigate('edv')">ğŸ“‹ ÆDV HesabatÄ±</div>
        <div class="ql" onclick="navigate('import')">ğŸ“¥ Excel Ä°dxal</div>
        <div class="ql" onclick="navigate('bank')">ğŸ¦ Bank Analizi</div>
        <div class="ql" onclick="navigate('companies')">ğŸ¢ ÅirkÉ™t KartÄ±</div>
        <div class="ql" href="qanunlar.html" onclick="window.open('qanunlar.html')">âš–ï¸ Qanunlar</div>
      </div>

      <!-- ÅirkÉ™tlÉ™r cÉ™dvÉ™li -->
      <div class="sec-title">ÅirkÉ™tlÉ™r</div>
      <div class="card">
        <div class="card-head">
          <h3>ğŸ“‹ ÅirkÉ™t SiyahÄ±sÄ±</h3>
          <span class="muted">1 ÅŸirkÉ™t</span>
        </div>
        <div class="tbl-wrap">
          <table>
            <thead>
              <tr>
                <th>ÅirkÉ™tin AdÄ±</th>
                <th>VÃ–EN</th>
                <th>NÉ™zarÉ™tÃ§i</th>
                <th>Cari Ä°ÅŸÃ§i</th>
                <th>Vergi Borcu</th>
                <th>Status</th>
              </tr>
            </thead>
            <tbody id="dashboard-table">
              <tr onclick="openCompanyCard()">
                <td><strong>"3V" MMC</strong></td>
                <td>2302351311</td>
                <td>â€”</td>
                <td>Zeyd</td>
                <td class="num" style="color:var(--red)">13,567 â‚¼</td>
                <td><span class="badge warn"><span class="dot warn"></span>Borclu</span></td>
              </tr>
            </tbody>
          </table>
        </div>
      </div>

      <!-- Bank qrafik -->
      <div class="sec-title">Bank DÃ¶vriyyÉ™si Trendi</div>
      <div class="card">
        <div class="card-head"><h3>ğŸ“ˆ AylÄ±q Bank DÃ¶vriyyÉ™si (â‚¼)</h3></div>
        <div class="chart-wrap">
          <canvas id="bankChart"></canvas>
        </div>
      </div>
    </div>

    <!-- â•â• ÅÄ°RKÆTLÆR â•â• -->
    <div class="page" id="page-companies">
      <!-- List view -->
      <div id="company-list">
        <div class="sec-title">ÅirkÉ™t SiyahÄ±sÄ±</div>
        <div class="ql-row" style="margin-bottom:16px">
          <button class="btn primary" onclick="openAddModal()">+ ÅirkÉ™t ÆlavÉ™ Et</button>
        </div>
        <div class="card">
          <div class="tbl-wrap">
            <table>
              <thead>
                <tr>
                  <th>ÅirkÉ™tin AdÄ±</th>
                  <th>VÃ–EN</th>
                  <th>RÉ™hbÉ™r</th>
                  <th>Status</th>
                  <th>Vergi Borcu</th>
                  <th>ÆmÉ™liyyat</th>
                </tr>
              </thead>
              <tbody>
                <tr>
                  <td><strong onclick="openCompanyCard()" style="cursor:pointer;color:var(--accent)">"3V" MMC</strong></td>
                  <td>2302351311</td>
                  <td>â€”</td>
                  <td><span class="badge ok"><span class="dot ok"></span>Aktiv</span></td>
                  <td class="num" style="color:var(--red)">13,567 â‚¼</td>
                  <td><button class="btn ghost" onclick="openCompanyCard()" style="font-size:.72rem;padding:5px 10px">Bax â†’</button></td>
                </tr>
              </tbody>
            </table>
          </div>
        </div>
      </div>

      <!-- Detail view -->
      <div id="company-detail" class="company-card">
        <button class="back-btn" onclick="backToList()">â† SiyahÄ±ya qayÄ±t</button>

        <div class="company-header">
          <div class="company-avatar">ğŸ¬</div>
          <div>
            <h2>"3V" MÉ™hdud MÉ™suliyyÉ™tli CÉ™miyyÉ™ti</h2>
            <p>VÃ–EN: 2302351311 &nbsp;Â·&nbsp; ÆDV VD: 19 &nbsp;Â·&nbsp; FÉ™aliyyÉ™t: UÅŸaq geyimlÉ™ri (Panda Kids)</p>
          </div>
          <div style="margin-left:auto"><span class="badge ok">Aktiv</span></div>
        </div>

        <div class="grid2">
          <!-- Ãœmumi mÉ™lumat -->
          <div class="card">
            <div class="card-head"><h3>ğŸ“‹ Ãœmumi MÉ™lumatlar</h3></div>
            <div class="info-grid">
              <div class="info-item"><div class="key">Tam hÃ¼quqi ad</div><div class="val">"3V" MMC</div></div>
              <div class="info-item"><div class="key">VÃ–EN</div><div class="val">2302351311</div></div>
              <div class="info-item"><div class="key">ÆDV qeydiyyat nÃ¶mrÉ™si (VD)</div><div class="val">19</div></div>
              <div class="info-item"><div class="key">FÉ™aliyyÉ™t sahÉ™si</div><div class="val">PÉ™rakÉ™ndÉ™ ticarÉ™t</div></div>
              <div class="info-item"><div class="key">NÉ™zarÉ™tÃ§i ÅŸÉ™xs</div><div class="val">â€”</div></div>
              <div class="info-item"><div class="key">Cari iÅŸÃ§i</div><div class="val">Zeyd</div></div>
            </div>
          </div>

          <!-- Vergi mÃ¼kkÉ™llÉ™fiyyÉ™tlÉ™ri -->
          <div class="card">
            <div class="card-head"><h3>âš–ï¸ Vergi MÃ¼kkÉ™llÉ™fiyyÉ™tlÉ™ri</h3></div>
            <div class="muk-item"><span class="muk-icon">ğŸ“‹</span><span>ÆDV (ÆlavÉ™ DÉ™yÉ™r Vergisi)</span><span class="badge ok" style="margin-left:auto">Aktiv</span></div>
            <div class="muk-item"><span class="muk-icon">ğŸ’¼</span><span>MÉ™nfÉ™É™t Vergisi (20%)</span><span class="badge ok" style="margin-left:auto">Aktiv</span></div>
            <div class="muk-item"><span class="muk-icon">ğŸ‘¤</span><span>GÉ™lir Vergisi (ÆmÉ™k haqqÄ±)</span><span class="badge ok" style="margin-left:auto">Aktiv</span></div>
            <div class="muk-item"><span class="muk-icon">ğŸ›ï¸</span><span>DSMF (22% + 3%)</span><span class="badge ok" style="margin-left:auto">Aktiv</span></div>
            <div class="muk-item"><span class="muk-icon">ğŸ¥</span><span>Ä°cbari Tibbi SÄ±ÄŸorta</span><span class="badge ok" style="margin-left:auto">Aktiv</span></div>
            <div class="muk-item"><span class="muk-icon">ğŸ </span><span>Æmlak Vergisi</span><span class="badge warn" style="margin-left:auto">YoxlanÄ±lÄ±r</span></div>
          </div>
        </div>

        <!-- Hesabatlar -->
        <div class="card">
          <div class="card-head"><h3>ğŸ“… VerilmÉ™li Hesabatlar (2026)</h3></div>
          <div class="report-row">
            <span class="report-name">ÆDV BÉ™yannamÉ™si â€” Dekabr 2025</span>
            <span class="report-deadline">20.01.2026</span>
            <span class="badge ok">âœ… VerilmiÅŸdir</span>
            <button class="report-action" onclick="navigate('edv')">Bax</button>
          </div>
          <div class="report-row">
            <span class="report-name">Vahid MÃ¼zdlu Hesabat â€” Yanvar 2026</span>
            <span class="report-deadline">20.02.2026</span>
            <span class="badge err">âŒ VerilmÉ™yib</span>
            <button class="report-action" onclick="navigate('reports')">HazÄ±rla</button>
          </div>
          <div class="report-row">
            <span class="report-name">ÆDV BÉ™yannamÉ™si â€” Yanvar 2026</span>
            <span class="report-deadline">20.02.2026</span>
            <span class="badge warn">ğŸ”„ HazÄ±rlanÄ±r</span>
            <button class="report-action" onclick="navigate('edv')">Davam et</button>
          </div>
          <div class="report-row">
            <span class="report-name">ÆDV BÉ™yannamÉ™si â€” Fevral 2026</span>
            <span class="report-deadline">20.03.2026</span>
            <span class="badge info">ğŸ“Œ GÃ¶zlÉ™yir</span>
            <button class="report-action" onclick="navigate('edv')">BaÅŸla</button>
          </div>
          <div class="report-row">
            <span class="report-name">MÉ™nfÉ™É™t Vergisi BÉ™yannamÉ™si â€” 2025</span>
            <span class="report-deadline">31.03.2026</span>
            <span class="badge info">ğŸ“Œ GÃ¶zlÉ™yir</span>
            <button class="report-action" onclick="navigate('reports')">BaÅŸla</button>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â• ÆDV HESABATI â•â• -->
    <div class="page" id="page-edv">

      <!-- Period selector -->
      <div style="display:flex;align-items:center;gap:14px;margin-bottom:20px;flex-wrap:wrap">
        <div>
          <label style="font-size:.7rem;color:var(--muted);display:block;margin-bottom:4px">Hesabat AyÄ±</label>
          <select id="edv-ay" onchange="edvPeriodChange()" style="background:var(--card2);border:1px solid var(--border);color:var(--text);padding:8px 14px;border-radius:8px;font-size:.82rem">
            <option value="12-2025" selected>Dekabr 2025 âœ…</option>
            <option value="01-2026">Yanvar 2026 ğŸ”„</option>
            <option value="02-2026">Fevral 2026 ğŸ“Œ</option>
          </select>
        </div>
        <div>
          <label style="font-size:.7rem;color:var(--muted);display:block;margin-bottom:4px">ÅirkÉ™t</label>
          <select style="background:var(--card2);border:1px solid var(--border);color:var(--text);padding:8px 14px;border-radius:8px;font-size:.82rem">
            <option>"3V" MMC â€” 2302351311</option>
          </select>
        </div>
        <div style="margin-left:auto;display:flex;gap:8px">
          <button class="btn primary" onclick="edvHesabla()">ğŸ”„ Hesabla</button>
          <button class="btn ghost" onclick="downloadEdvExcel()">â¬‡ï¸ Excel</button>
          <button class="btn success" onclick="alert('e-taxes.gov.az-a gÃ¶ndÉ™rmÉ™ funksiyasÄ± hazÄ±rlanÄ±r...')">ğŸ“¤ e-taxes</button>
        </div>
      </div>

      <!-- Status alert -->
      <div id="edv-status-alert" class="alert ok">âœ… Dekabr 2025 bÉ™yannamÉ™si 18.01.2026 tarixdÉ™ vaxtÄ±nda tÉ™qdim edilmiÅŸdir.</div>

      <!-- ÆDV AxÄ±n -->
      <div class="vat-flow" style="margin-bottom:20px">
        <div class="vf-box out"><div class="vf-lbl">Ã‡Ä±xÄ±ÅŸ ÆDV (SatÄ±ÅŸ 1101)</div><div class="vf-val" id="vf-cixis">29,425.43 â‚¼</div><div style="font-size:.68rem;color:var(--muted);margin-top:4px" id="vf-dovriyye">DÃ¶vriyyÉ™: 163,474.59 â‚¼</div></div>
        <div class="vf-op">âˆ’</div>
        <div class="vf-box inn"><div class="vf-lbl">GiriÅŸ ÆDV (ÆvÉ™zlÉ™ÅŸmÉ™ 1016)</div><div class="vf-val" id="vf-giris">15,858.18 â‚¼</div><div style="font-size:.68rem;color:var(--muted);margin-top:4px" id="vf-giris-sub">3 mÉ™nbÉ™ Ã¼zrÉ™</div></div>
        <div class="vf-op">=</div>
        <div class="vf-box res"><div class="vf-lbl">Ã–dÉ™nilmÉ™li ÆDV (1023)</div><div class="vf-val" id="vf-net">13,567.25 â‚¼</div><div style="font-size:.68rem;color:var(--muted);margin-top:4px" id="vf-net-sub">BÃ¼dcÉ™yÉ™ Ã¶dÉ™nilib</div></div>
      </div>

      <!-- 3 KATEQORÄ°YA -->
      <div class="sec-title">ğŸ“‚ ÆvÉ™zlÉ™ÅŸdirmÉ™ KateqoriyalarÄ± Ã¼zrÉ™</div>

      <!-- KAT 1: QAÄ°MÆLÆR -->
      <div class="card" style="border-left:4px solid var(--accent)">
        <div class="card-head">
          <h3>ğŸ“‹ 1. QaimÉ™lÉ™rÉ™ gÃ¶rÉ™ (ÆDV Depozit HesabÄ±)</h3>
          <span class="muted" id="kat1-toplam">15,858.18 â‚¼</span>
          <button class="btn ghost" style="font-size:.7rem;padding:4px 10px;margin-left:8px" onclick="document.getElementById('file-kat1').click()">ğŸ“¥ Excel Ä°dxal</button>
          <input type="file" id="file-kat1" accept=".xlsx,.xls" style="display:none" onchange="importEdvDeposit(this)">
        </div>
        <div class="tbl-wrap">
          <table id="tbl-kat1">
            <thead>
              <tr>
                <th>#</th>
                <th>Tarix</th>
                <th>TÉ™chizatÃ§Ä±</th>
                <th>VÃ–EN</th>
                <th>EQF Seriya</th>
                <th>EQF NÃ¶mrÉ™</th>
                <th class="num">ÆDV MÉ™blÉ™ÄŸi (â‚¼)</th>
                <th>BÃ¼dcÉ™ Kodu</th>
                <th>Status</th>
                <th>ÆmÉ™liyyat</th>
              </tr>
            </thead>
            <tbody id="tbody-kat1">
              <tr>
                <td>1</td><td>29-01-2026</td>
                <td contenteditable="true">LUKOIL-AZÆRBAYCAN QSC</td>
                <td>9900006931</td>
                <td>MT2601</td><td>â€”</td>
                <td class="num" contenteditable="true">36.00</td>
                <td>114111</td>
                <td><span class="badge ok">âœ… Ã–dÉ™nildi</span></td>
                <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:.8rem">ğŸ—‘</button></td>
              </tr>
              <tr>
                <td>2</td><td>29-01-2026</td>
                <td contenteditable="true">ALAZAN TEKSTÄ°L MMC</td>
                <td>1309355061</td>
                <td>MT2601</td><td>11463630</td>
                <td class="num" contenteditable="true">270.00</td>
                <td>114111</td>
                <td><span class="badge ok">âœ… Ã–dÉ™nildi</span></td>
                <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:.8rem">ğŸ—‘</button></td>
              </tr>
              <tr>
                <td>3</td><td>29-01-2026</td>
                <td contenteditable="true">MÄ°RE-5 MMC</td>
                <td>1906496911</td>
                <td>MT2601</td><td>10711345</td>
                <td class="num" contenteditable="true">900.00</td>
                <td>114111</td>
                <td><span class="badge ok">âœ… Ã–dÉ™nildi</span></td>
                <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:.8rem">ğŸ—‘</button></td>
              </tr>
              <tr>
                <td>4</td><td>27-01-2026</td>
                <td contenteditable="true">FACÄ°LÄ°TY MANAGEMENT GROUP MMC</td>
                <td>1403645031</td>
                <td>MT2601</td><td>11704067</td>
                <td class="num" contenteditable="true">756.61</td>
                <td>114111</td>
                <td><span class="badge ok">âœ… Ã–dÉ™nildi</span></td>
                <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:.8rem">ğŸ—‘</button></td>
              </tr>
              <tr>
                <td>5</td><td>14-01-2026</td>
                <td contenteditable="true">MÄ°RE-5 MMC</td>
                <td>1906496911</td>
                <td>MT2512</td><td>12316836</td>
                <td class="num" contenteditable="true">540.00</td>
                <td>114111</td>
                <td><span class="badge ok">âœ… Ã–dÉ™nildi</span></td>
                <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer;font-size:.8rem">ğŸ—‘</button></td>
              </tr>
              <tr id="kat1-digÉ™r">
                <td>â€¦</td><td>â€”</td>
                <td>DigÉ™r (188 É™mÉ™liyyat)</td>
                <td>â€”</td><td>â€”</td><td>â€”</td>
                <td class="num">13,355.57</td>
                <td>114111</td>
                <td><span class="badge ok">âœ…</span></td>
                <td></td>
              </tr>
            </tbody>
            <tfoot>
              <tr style="background:rgba(99,102,241,.08);font-weight:700">
                <td colspan="6">CÆMÄ° â€” QaimÉ™lÉ™rÉ™ gÃ¶rÉ™ É™vÉ™zlÉ™ÅŸdirmÉ™</td>
                <td class="num" id="kat1-cem">15,858.18 â‚¼</td>
                <td colspan="3"></td>
              </tr>
            </tfoot>
          </table>
        </div>
        <div style="margin-top:10px;display:flex;gap:8px">
          <button class="btn ghost" style="font-size:.75rem" onclick="addKat1Row()">+ SÉ™tir É™lavÉ™ et</button>
          <button class="btn ghost" style="font-size:.75rem" onclick="recalcKat1()">ğŸ”„ YenidÉ™n hesabla</button>
        </div>
      </div>

      <!-- KAT 2: KASSA -->
      <div class="card" style="border-left:4px solid var(--yellow)">
        <div class="card-head">
          <h3>ğŸ§¾ 2. Kassaya gÃ¶rÉ™ (NaÄŸd Ã¶dÉ™niÅŸlÉ™r / NKA Ã§eklÉ™ri)</h3>
          <span class="muted" id="kat2-toplam">0.00 â‚¼</span>
          <button class="btn ghost" style="font-size:.7rem;padding:4px 10px;margin-left:8px" onclick="document.getElementById('file-kat2img').click()">ğŸ“· Ã‡ek ÅÉ™kli</button>
          <input type="file" id="file-kat2img" accept="image/*" multiple style="display:none" onchange="importKassaImages(this)">
        </div>
        <div class="alert warn" style="margin-bottom:12px">âš ï¸ Kassa Ã§eklÉ™rindÉ™ki ÆDV É™vÉ™zlÉ™ÅŸdirilmÉ™si Ã¼Ã§Ã¼n VM maddÉ™ 175-É™ gÃ¶rÉ™ bank kÃ¶Ã§Ã¼rmÉ™si ÅŸÉ™rti tÉ™tbiq olunmur. Lakin NKA sistemi Ã¼zrÉ™ Ã§ek faktiki Ã¶dÉ™niÅŸin sÃ¼butu sayÄ±lÄ±r.</div>

        <div id="kassa-images" style="display:flex;flex-wrap:wrap;gap:10px;margin-bottom:12px"></div>

        <div class="tbl-wrap">
          <table id="tbl-kat2">
            <thead>
              <tr>
                <th>#</th>
                <th>Tarix</th>
                <th>SatÄ±cÄ±</th>
                <th>NKA Ã‡ek â„–</th>
                <th class="num">CÉ™mi MÉ™blÉ™ÄŸ (â‚¼)</th>
                <th class="num">ÆDV (18%) (â‚¼)</th>
                <th>MÉ™nbÉ™</th>
                <th>ÆmÉ™liyyat</th>
              </tr>
            </thead>
            <tbody id="tbody-kat2">
              <tr>
                <td colspan="8" style="text-align:center;color:var(--muted);padding:20px;font-size:.8rem">
                  ğŸ“· Kassa Ã§eki ÅŸÉ™kli yÃ¼klÉ™yin â€” sistem avtomatik oxuyacaq<br>
                  <small>vÉ™ ya aÅŸaÄŸÄ±dan É™l ilÉ™ É™lavÉ™ edin</small>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr style="background:rgba(245,158,11,.08);font-weight:700">
                <td colspan="5">CÆMÄ° â€” Kassaya gÃ¶rÉ™ É™vÉ™zlÉ™ÅŸdirmÉ™</td>
                <td class="num" id="kat2-cem">0.00 â‚¼</td>
                <td colspan="2"></td>
              </tr>
            </tfoot>
          </table>
        </div>
        <div style="margin-top:10px">
          <button class="btn ghost" style="font-size:.75rem" onclick="addKat2Row()">+ Æl ilÉ™ É™lavÉ™ et</button>
        </div>
      </div>

      <!-- KAT 3: Ä°DXAL -->
      <div class="card" style="border-left:4px solid var(--accent2)">
        <div class="card-head">
          <h3>ğŸš¢ 3. Ä°dxal Ã¼zrÉ™ Ã¶dÉ™nilmiÅŸ ÆDV (GÃ¶mrÃ¼k)</h3>
          <span class="muted" id="kat3-toplam">0.00 â‚¼</span>
          <button class="btn ghost" style="font-size:.7rem;padding:4px 10px;margin-left:8px" onclick="document.getElementById('file-kat3').click()">ğŸ“¥ Excel Ä°dxal</button>
          <input type="file" id="file-kat3" accept=".xlsx,.xls" style="display:none" onchange="importIdxal(this)">
        </div>
        <div class="alert info" style="margin-bottom:12px">ğŸ“Œ Ä°dxalda Ã¶dÉ™nilmiÅŸ ÆDV gÃ¶mrÃ¼k bÉ™yannamÉ™si É™sasÄ±nda É™vÉ™zlÉ™ÅŸdirilir. SÉ™nÉ™d: ÆDV-nin gÃ¶mrÃ¼kdÉ™ Ã¶dÉ™nildiyini gÃ¶stÉ™rÉ™n gÃ¶mrÃ¼k bÉ™yannamÉ™si.</div>
        <div class="tbl-wrap">
          <table id="tbl-kat3">
            <thead>
              <tr>
                <th>#</th>
                <th>Tarix</th>
                <th>GÃ¶mrÃ¼k BÉ™yannamÉ™ â„–</th>
                <th>MalÄ±n adÄ±</th>
                <th>Ä°dxalÃ§Ä± Ã¶lkÉ™</th>
                <th class="num">GÃ¶mrÃ¼k DÉ™yÉ™ri (â‚¼)</th>
                <th class="num">Ä°dxal ÆDV-si (â‚¼)</th>
                <th>ÆmÉ™liyyat</th>
              </tr>
            </thead>
            <tbody id="tbody-kat3">
              <tr>
                <td colspan="8" style="text-align:center;color:var(--muted);padding:20px;font-size:.8rem">
                  ğŸ“¥ GÃ¶mrÃ¼k bÉ™yannamÉ™si Excel faylÄ±nÄ± yÃ¼klÉ™yin<br>
                  <small>DÃ¶vlÉ™t GÃ¶mrÃ¼k KomitÉ™si Ã§Ä±xarÄ±ÅŸÄ±</small>
                </td>
              </tr>
            </tbody>
            <tfoot>
              <tr style="background:rgba(16,185,129,.08);font-weight:700">
                <td colspan="6">CÆMÄ° â€” Ä°dxal Ã¼zrÉ™ É™vÉ™zlÉ™ÅŸdirmÉ™</td>
                <td class="num" id="kat3-cem">0.00 â‚¼</td>
                <td></td>
              </tr>
            </tfoot>
          </table>
        </div>
        <div style="margin-top:10px">
          <button class="btn ghost" style="font-size:.75rem" onclick="addKat3Row()">+ Æl ilÉ™ É™lavÉ™ et</button>
        </div>
      </div>

      <!-- YEKÄ°N HESABLAMA -->
      <div class="card" style="background:linear-gradient(135deg,var(--card),var(--card2));border:1px solid var(--accent)">
        <div class="card-head"><h3>ğŸ“Š Yekun ÆDV ÆvÉ™zlÉ™ÅŸdirmÉ™ CÉ™dvÉ™li</h3></div>
        <div class="tbl-wrap">
          <table>
            <thead><tr><th>Kateqoriya</th><th>Æsas</th><th class="num">MÉ™blÉ™ÄŸ (â‚¼)</th><th>% PayÄ±</th></tr></thead>
            <tbody>
              <tr>
                <td>ğŸ“‹ QaimÉ™lÉ™rÉ™ gÃ¶rÉ™</td>
                <td>ÆDV depozit hesabÄ± Ã¶dÉ™niÅŸlÉ™ri</td>
                <td class="num" id="yekun-kat1">15,858.18</td>
                <td id="yekun-kat1-pct">100.0%</td>
              </tr>
              <tr>
                <td>ğŸ§¾ Kassaya gÃ¶rÉ™</td>
                <td>NKA Ã§eklÉ™ri</td>
                <td class="num" id="yekun-kat2">0.00</td>
                <td id="yekun-kat2-pct">0.0%</td>
              </tr>
              <tr>
                <td>ğŸš¢ Ä°dxal Ã¼zrÉ™</td>
                <td>GÃ¶mrÃ¼k bÉ™yannamÉ™si</td>
                <td class="num" id="yekun-kat3">0.00</td>
                <td id="yekun-kat3-pct">0.0%</td>
              </tr>
              <tr style="font-weight:800;background:rgba(99,102,241,.1);font-size:.95rem">
                <td colspan="2">ğŸ”¢ CÆMÄ° ÆVÆZLÆÅDÄ°RÄ°LÆN ÆDV (GÃ¶stÉ™rici 1016)</td>
                <td class="num" id="yekun-total" style="color:var(--accent2)">15,858.18 â‚¼</td>
                <td>100%</td>
              </tr>
            </tbody>
          </table>
        </div>

        <div style="margin-top:16px;display:flex;gap:10px;flex-wrap:wrap">
          <button class="btn primary" onclick="edvHesabla()">ğŸ”„ YenidÉ™n Hesabla</button>
          <button class="btn success" onclick="downloadAvazFull()">â¬‡ï¸ ÆvÉ™zlÉ™ÅŸdirmÉ™ Excel</button>
          <button class="btn ghost" onclick="downloadEdvExcel()">ğŸ“Š Tam Hesabat</button>
          <button class="btn ghost" style="border-color:var(--accent2);color:var(--accent2)" onclick="alert('e-taxes.gov.az XML bÉ™yannamÉ™si hazÄ±rlanÄ±r...')">ğŸ“¤ XML BÉ™yannamÉ™</button>
        </div>
      </div>

    </div>

    <!-- â•â• DÄ°GÆR HESABATLAR â•â• -->
    <div class="page" id="page-reports">
      <div class="sec-title">Hesabat Ä°darÉ™etmÉ™si</div>
      <div class="card">
        <div class="card-head"><h3>ğŸ“ BÃ¼tÃ¼n Hesabatlar â€” 2026</h3></div>
        <div class="tbl-wrap">
          <table>
            <thead><tr><th>Hesabat nÃ¶vÃ¼</th><th>ÅirkÉ™t</th><th>DÃ¶vr</th><th>Son tarix</th><th>Status</th><th>ÆmÉ™liyyat</th></tr></thead>
            <tbody>
              <tr><td>ÆDV BÉ™yannamÉ™si</td><td>3V MMC</td><td>Dekabr 2025</td><td>20.01.2026</td><td><span class="badge ok">âœ… Verildi</span></td><td><button class="btn ghost" style="font-size:.7rem;padding:4px 10px" onclick="navigate('edv')">Bax</button></td></tr>
              <tr><td>Vahid MÃ¼zdlu Hesabat</td><td>3V MMC</td><td>Yanvar 2026</td><td>20.02.2026</td><td><span class="badge err">âŒ VerilmÉ™yib</span></td><td><button class="btn primary" style="font-size:.7rem;padding:4px 10px">HazÄ±rla</button></td></tr>
              <tr><td>ÆDV BÉ™yannamÉ™si</td><td>3V MMC</td><td>Yanvar 2026</td><td>20.02.2026</td><td><span class="badge warn">ğŸ”„ HazÄ±rlanÄ±r</span></td><td><button class="btn ghost" style="font-size:.7rem;padding:4px 10px" onclick="navigate('edv')">Davam</button></td></tr>
              <tr><td>ÆDV BÉ™yannamÉ™si</td><td>3V MMC</td><td>Fevral 2026</td><td>20.03.2026</td><td><span class="badge info">ğŸ“Œ GÃ¶zlÉ™yir</span></td><td><button class="btn ghost" style="font-size:.7rem;padding:4px 10px">BaÅŸla</button></td></tr>
              <tr><td>MÉ™nfÉ™É™t Vergisi BÉ™yannamÉ™si</td><td>3V MMC</td><td>2025 (Ä°llik)</td><td>31.03.2026</td><td><span class="badge info">ğŸ“Œ GÃ¶zlÉ™yir</span></td><td><button class="btn ghost" style="font-size:.7rem;padding:4px 10px">BaÅŸla</button></td></tr>
              <tr><td>DSMF HesabatÄ±</td><td>3V MMC</td><td>Yanvar 2026</td><td>20.02.2026</td><td><span class="badge err">âŒ VerilmÉ™yib</span></td><td><button class="btn primary" style="font-size:.7rem;padding:4px 10px">HazÄ±rla</button></td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

    <!-- â•â• Ä°DXAL â•â• -->
    <div class="page" id="page-import">
      <div class="sec-title">Excel Ä°dxalÄ±</div>

      <div class="tabs">
        <button class="tab-btn active" onclick="switchTab(this,'imp-qaimeler')">ğŸ“‹ QaimÉ™lÉ™r</button>
        <button class="tab-btn" onclick="switchTab(this,'imp-bank')">ğŸ¦ Bank Ã‡Ä±xarÄ±ÅŸÄ±</button>
        <button class="tab-btn" onclick="switchTab(this,'imp-edv')">ğŸ“Š ÆDV Sub-uÃ§ot</button>
        <button class="tab-btn" onclick="switchTab(this,'imp-avaz')">ğŸ”„ ÆvÉ™zlÉ™ÅŸdirmÉ™</button>
      </div>

      <div class="tab-pane active" id="imp-qaimeler">
        <div class="alert info">ğŸ“Œ <strong>Format:</strong> e-taxes.gov.az-dan yÃ¼klÉ™nmiÅŸ "Daxil olan qaimÉ™lÉ™rin siyahÄ±sÄ±" vÉ™ "GÃ¶ndÉ™rilÉ™n qaimÉ™lÉ™rin siyahÄ±sÄ±" Excel fayllarÄ±. BaÅŸlÄ±q sÉ™tri: â„–, VÃ–EN, AdÄ±, Tipi, VÉ™ziyyÉ™ti...</div>
        <div class="grid2">
          <div class="card">
            <div class="card-head"><h3>ğŸ“¥ Daxil Olan QaimÉ™lÉ™r</h3></div>
            <div class="drop-zone" onclick="document.getElementById('file-daxil').click()" ondragover="event.preventDefault();this.classList.add('drag')" ondrop="handleDrop(event,'daxil')">
              <div style="font-size:2rem">ğŸ“‚</div>
              <p>Excel faylÄ± buraya atÄ±n vÉ™ ya <strong style="color:var(--accent)">seÃ§in</strong></p>
              <p style="font-size:.7rem;margin-top:4px">Daxil olan qaimÉ™lÉ™rin siyahÄ±sÄ± (.xlsx)</p>
            </div>
            <input type="file" id="file-daxil" accept=".xlsx" style="display:none" onchange="handleFile(this,'daxil')">
            <div class="file-list" id="list-daxil">
              <div class="file-item">
                <span class="fi-icon">ğŸ“Š</span>
                <span class="fi-name">file_27 â€” Daxil olan qaimÉ™lÉ™r (01.11.2025â€“01.02.2026)</span>
                <span class="fi-status badge ok">âœ… Ä°dxal edildi</span>
              </div>
            </div>
            <div style="margin-top:8px;font-size:.75rem;color:var(--muted)">157 qaimÉ™ Â· CÉ™mi: 264,054.41 â‚¼ Â· ÆDV: 35,277.54 â‚¼</div>
          </div>
          <div class="card">
            <div class="card-head"><h3>ğŸ“¤ GÃ¶ndÉ™rilÉ™n QaimÉ™lÉ™r</h3></div>
            <div class="drop-zone" onclick="document.getElementById('file-gond').click()">
              <div style="font-size:2rem">ğŸ“‚</div>
              <p>Excel faylÄ± buraya atÄ±n vÉ™ ya <strong style="color:var(--accent)">seÃ§in</strong></p>
              <p style="font-size:.7rem;margin-top:4px">GÃ¶ndÉ™rilÉ™n qaimÉ™lÉ™rin siyahÄ±sÄ± (.xlsx)</p>
            </div>
            <input type="file" id="file-gond" accept=".xlsx" style="display:none" onchange="handleFile(this,'gond')">
            <div class="file-list" id="list-gond">
              <div class="file-item">
                <span class="fi-icon">ğŸ“Š</span>
                <span class="fi-name">file_26 â€” GÃ¶ndÉ™rilÉ™n qaimÉ™lÉ™r (01.11.2025â€“01.02.2026)</span>
                <span class="fi-status badge ok">âœ… Ä°dxal edildi</span>
              </div>
            </div>
            <div style="margin-top:8px;font-size:.75rem;color:var(--muted)">28 qaimÉ™ Â· ELLAB MMC É™sas alÄ±cÄ±</div>
          </div>
        </div>
        <div style="text-align:center;margin-top:8px">
          <button class="btn primary" onclick="navigate('edv')">ğŸ“‹ ÆDV HesabatÄ±nÄ± Hesabla â†’</button>
        </div>
      </div>

      <div class="tab-pane" id="imp-bank">
        <div class="alert info">ğŸ“Œ <strong>Format:</strong> BankÄ±n "Hesabdan Ã‡Ä±xarÄ±ÅŸ" Excel faylÄ±. SÃ¼tunlar: Tarix, SÉ™nÉ™d nÃ¶mrÉ™si, Æks hesab, MÉ™blÉ™ÄŸ, Valyuta, Balans, TÉ™yinat.</div>
        <div class="grid2">
          <div class="card">
            <div class="card-head"><h3>ğŸ›ï¸ AIIB Bank</h3></div>
            <div class="drop-zone" onclick="document.getElementById('file-aiib').click()">
              <div style="font-size:2rem">ğŸ“‚</div>
              <p>Excel faylÄ± buraya atÄ±n</p>
            </div>
            <input type="file" id="file-aiib" accept=".xlsx" style="display:none">
            <div class="file-item" style="margin-top:12px">
              <span class="fi-icon">ğŸ“Š</span>
              <span class="fi-name">file_28 â€” AIIB Bank (01.12.2025â€“28.02.2026)</span>
              <span class="fi-status badge ok">âœ… Ä°dxal edildi</span>
            </div>
            <div style="margin-top:8px;font-size:.75rem;color:var(--muted)">1,394 É™mÉ™liyyat Â· Kredit: 546,573 â‚¼ Â· Debit: 549,004 â‚¼</div>
          </div>
          <div class="card">
            <div class="card-head"><h3>ğŸ›ï¸ Ä°BAZ Bank</h3></div>
            <div class="drop-zone" onclick="document.getElementById('file-ibaz').click()">
              <div style="font-size:2rem">ğŸ“‚</div>
              <p>Excel faylÄ± buraya atÄ±n</p>
            </div>
            <input type="file" id="file-ibaz" accept=".xlsx" style="display:none">
            <div class="file-item" style="margin-top:12px">
              <span class="fi-icon">ğŸ“Š</span>
              <span class="fi-name">file_29 â€” Ä°BAZ Bank (01.12.2025â€“31.01.2026)</span>
              <span class="fi-status badge ok">âœ… Ä°dxal edildi</span>
            </div>
            <div style="margin-top:8px;font-size:.75rem;color:var(--muted)">608 É™mÉ™liyyat Â· Kredit: 347,071 â‚¼ Â· Debit: 346,944 â‚¼</div>
          </div>
        </div>
      </div>

      <div class="tab-pane" id="imp-edv">
        <div class="alert info">ğŸ“Œ <strong>Format:</strong> Bank ÆDV sub-uÃ§ot hesabÄ± Ã§Ä±xarÄ±ÅŸÄ±. SÃ¼tunlar: â„–, VÃ–EN, Ad, Tarix, MÉ™daxil, MÉ™xaric, HesabÄ±n nÃ¶vÃ¼, EQF seriya, EQF nÃ¶mrÉ™, BÃ¼dcÉ™ kodu.</div>
        <div class="card">
          <div class="card-head"><h3>ğŸ”’ ÆDV Sub-UÃ§ot HesabÄ±</h3></div>
          <div class="drop-zone" onclick="document.getElementById('file-edvsub').click()">
            <div style="font-size:2rem">ğŸ“‚</div>
            <p>Excel faylÄ± buraya atÄ±n</p>
          </div>
          <input type="file" id="file-edvsub" accept=".xlsx" style="display:none">
          <div class="file-item" style="margin-top:12px">
            <span class="fi-icon">ğŸ“Š</span>
            <span class="fi-name">file_30 â€” ÆDV Sub-uÃ§ot (01.12.2025â€“31.01.2026)</span>
            <span class="fi-status badge ok">âœ… Ä°dxal edildi</span>
          </div>
          <div style="margin-top:8px;font-size:.75rem;color:var(--muted)">193 É™mÉ™liyyat Â· MÉ™xaric: 29,162 â‚¼ Â· BÃ¼dcÉ™ kodu: 114111</div>
        </div>
      </div>

      <div class="tab-pane" id="imp-avaz">
        <div class="alert info">ğŸ“Œ <strong>Format:</strong> e-taxes.gov.az-a yÃ¼klÉ™nmÉ™k Ã¼Ã§Ã¼n É™vÉ™zlÉ™ÅŸdirmÉ™ ÅŸablonu. 4 sÃ¼tun, baÅŸlÄ±q yoxdur: SÉ™tir kodu | EQF seriyasÄ± | EQF nÃ¶mrÉ™si | MÉ™blÉ™ÄŸ</div>
        <div class="card">
          <div class="card-head"><h3>ğŸ”„ ÆvÉ™zlÉ™ÅŸdirmÉ™ Åablonu</h3></div>
          <div class="drop-zone">
            <div style="font-size:2rem">ğŸ“‚</div>
            <p>MÃ¶vcud É™vÉ™zlÉ™ÅŸdirmÉ™ faylÄ±nÄ± yÃ¼klÉ™yin (yoxlamaq Ã¼Ã§Ã¼n)</p>
          </div>
          <div class="file-item" style="margin-top:12px">
            <span class="fi-icon">ğŸ“Š</span>
            <span class="fi-name">file_24 â€” ÆvÉ™zlÉ™ÅŸdirmÉ™ ÅŸablonu (308, MT2506, 10001748, 500 â‚¼)</span>
            <span class="fi-status badge ok">âœ… NÃ¼munÉ™</span>
          </div>
          <div style="margin-top:14px;display:flex;gap:10px">
            <button class="btn success" onclick="downloadAvaz()">â¬‡ï¸ Yeni ÆvÉ™zlÉ™ÅŸdirmÉ™ YÃ¼klÉ™</button>
          </div>
        </div>
      </div>
    </div>

    <!-- â•â• BANK â•â• -->
    <div class="page" id="page-bank">
      <div class="sec-title">Bank DÃ¶vriyyÉ™si Analizi</div>

      <div class="kpi-row">
        <div class="kpi green"><div class="kpi-lbl">AIIB Kredit</div><div class="kpi-val">546,573 â‚¼</div><div class="kpi-sub">01.12.2025 â€“ 28.02.2026</div></div>
        <div class="kpi red"><div class="kpi-lbl">AIIB Debit</div><div class="kpi-val">549,004 â‚¼</div><div class="kpi-sub">01.12.2025 â€“ 28.02.2026</div></div>
        <div class="kpi green"><div class="kpi-lbl">Ä°BAZ Kredit</div><div class="kpi-val">347,071 â‚¼</div><div class="kpi-sub">01.12.2025 â€“ 31.01.2026</div></div>
        <div class="kpi red"><div class="kpi-lbl">Ä°BAZ Debit</div><div class="kpi-val">346,944 â‚¼</div><div class="kpi-sub">01.12.2025 â€“ 31.01.2026</div></div>
      </div>

      <div class="grid2">
        <div class="card">
          <div class="card-head"><h3>ğŸ›ï¸ AIIB Bank â€” AZ08AIIB...8112</h3></div>
          <div class="chart-wrap"><canvas id="aiibChart"></canvas></div>
          <div style="margin-top:12px;font-size:.75rem;color:var(--muted)">
            POS satÄ±ÅŸ: 282,896 â‚¼ (51.8%) Â· 1,394 É™mÉ™liyyat<br>
            Ä°lkin qalÄ±q: 3,765.67 â‚¼ â†’ Son qalÄ±q: 1,335.08 â‚¼
          </div>
        </div>
        <div class="card">
          <div class="card-head"><h3>ğŸ›ï¸ Ä°BAZ Bank â€” AZ62IBAZ...8120</h3></div>
          <div class="chart-wrap"><canvas id="ibazChart"></canvas></div>
          <div style="margin-top:12px;font-size:.75rem;color:var(--muted)">
            USD alÄ±ÅŸÄ±: 133,450 â‚¼ Â· 608 É™mÉ™liyyat<br>
            Komisiya: 331.64 â‚¼ Â· Son qalÄ±q: 208.82 â‚¼
          </div>
        </div>
      </div>

      <div class="card">
        <div class="card-head"><h3>ğŸ’¸ Æsas Ã–dÉ™niÅŸlÉ™r (Ä°BAZ Bank)</h3></div>
        <div class="tbl-wrap">
          <table>
            <thead><tr><th>TÉ™chizatÃ§Ä± / Kateqoriya</th><th class="num">MÉ™blÉ™ÄŸ (â‚¼)</th><th>Qeyd</th></tr></thead>
            <tbody>
              <tr><td>USD alÄ±ÅŸÄ± (valyuta)</td><td class="num">133,450.00</td><td>Xarici mal idxalÄ± Ã¼Ã§Ã¼n</td></tr>
              <tr><td>PAHA hesabÄ± kÃ¶Ã§Ã¼rmÉ™si</td><td class="num">36,468.00</td><td>â€”</td></tr>
              <tr><td>AIIB Bank hesabÄ±na kÃ¶Ã§Ã¼rmÉ™</td><td class="num">25,375.00</td><td>Daxili kÃ¶Ã§Ã¼rmÉ™</td></tr>
              <tr><td>ÆmÉ™k haqqÄ± + YemÉ™k (Noyabr 2025)</td><td class="num">12,274.36</td><td>Ä°ÅŸÃ§i xÉ™rclÉ™ri</td></tr>
              <tr><td>DÃ¶vlÉ™t XÉ™zinÉ™sinÉ™</td><td class="num">8,240.00</td><td>Vergi Ã¶dÉ™niÅŸi</td></tr>
              <tr><td>Borc daxilolmasÄ± (17.12.2025 mÃ¼q.)</td><td class="num" style="color:var(--accent2)">68,000.00 â†‘</td><td>Kredit daxilolma</td></tr>
            </tbody>
          </table>
        </div>
      </div>
    </div>

  </div><!-- /content -->
</div><!-- /main -->

<!-- â•â• ADD COMPANY MODAL â•â• -->
<div class="modal-overlay" id="modal-add">
  <div class="modal">
    <button class="modal-close" onclick="closeModal()">âœ•</button>
    <h3>ğŸ¢ Yeni ÅirkÉ™t ÆlavÉ™ Et</h3>
    <div style="display:grid;gap:12px;margin-top:16px">
      <div><label style="font-size:.75rem;color:var(--muted)">ÅirkÉ™tin tam hÃ¼quqi adÄ±</label><br><input type="text" placeholder='"ABC" MMC' style="width:100%;background:var(--card2);border:1px solid var(--border);color:var(--text);padding:9px;border-radius:7px;margin-top:4px;font-size:.82rem"></div>
      <div><label style="font-size:.75rem;color:var(--muted)">VÃ–EN (10 rÉ™qÉ™m)</label><br><input type="text" placeholder="XXXXXXXXXX" maxlength="10" style="width:100%;background:var(--card2);border:1px solid var(--border);color:var(--text);padding:9px;border-radius:7px;margin-top:4px;font-size:.82rem"></div>
      <div><label style="font-size:.75rem;color:var(--muted)">RÉ™hbÉ™rin adÄ±</label><br><input type="text" style="width:100%;background:var(--card2);border:1px solid var(--border);color:var(--text);padding:9px;border-radius:7px;margin-top:4px;font-size:.82rem"></div>
      <div><label style="font-size:.75rem;color:var(--muted)">Vergi nÃ¶vÃ¼</label><br>
        <select style="width:100%;background:var(--card2);border:1px solid var(--border);color:var(--text);padding:9px;border-radius:7px;margin-top:4px;font-size:.82rem">
          <option>ÆDV Ã¶dÉ™yicisi</option>
          <option>SadÉ™lÉ™ÅŸdirilmiÅŸ vergi</option>
          <option>HÉ™r ikisi</option>
        </select>
      </div>
      <div style="display:flex;gap:10px;margin-top:8px">
        <button class="btn primary" style="flex:1" onclick="closeModal()">âœ… Yadda saxla</button>
        <button class="btn ghost" onclick="closeModal()">LÉ™ÄŸv et</button>
      </div>
    </div>
  </div>
</div>

<script>
// â”€â”€ NAVÄ°GASÄ°YA â”€â”€
const pages = {
  'dashboard':'Dashboard','companies':'ÅirkÉ™tlÉ™r','edv':'ÆDV HesabatÄ±',
  'reports':'Hesabatlar','import':'Excel Ä°dxalÄ±','bank':'Bank DÃ¶vriyyÉ™si'
};

function navigate(id) {
  document.querySelectorAll('.page').forEach(p=>p.classList.remove('active'));
  document.querySelectorAll('.nav-item').forEach(n=>n.classList.remove('active'));
  document.getElementById('page-'+id)?.classList.add('active');
  document.getElementById('page-title').textContent = pages[id]||id;
  document.querySelectorAll('.nav-item').forEach(n=>{
    if(n.getAttribute('onclick')?.includes("'"+id+"'")) n.classList.add('active');
  });
  if(id==='bank') setTimeout(initBankCharts,100);
  window.scrollTo(0,0);
}

function toggleSidebar(){
  document.getElementById('sidebar').classList.toggle('collapsed');
}

// â”€â”€ TAB â”€â”€
function switchTab(btn, id) {
  const tabGroup = btn.closest('.tabs').nextElementSibling;
  btn.closest('.tabs').querySelectorAll('.tab-btn').forEach(b=>b.classList.remove('active'));
  btn.classList.add('active');
  // find all tab panes in same parent
  let el = btn.closest('.tabs');
  while(el.nextElementSibling && el.nextElementSibling.classList.contains('tab-pane') || el.nextElementSibling?.classList.contains('tab-pane')){
    el = el.nextElementSibling;
    break;
  }
  // simpler approach
  const parent = btn.closest('.page')||btn.closest('.card')||btn.parentElement.parentElement;
  parent.querySelectorAll('.tab-pane').forEach(p=>p.classList.remove('active'));
  document.getElementById(id)?.classList.add('active');
}

// â”€â”€ COMPANY DETAIL â”€â”€
function openCompanyCard(){
  document.getElementById('company-list').style.display='none';
  document.getElementById('company-detail').classList.add('active');
  document.getElementById('page-title').textContent='"3V" MMC â€” ÅirkÉ™t KartÄ±';
}
function backToList(){
  document.getElementById('company-list').style.display='block';
  document.getElementById('company-detail').classList.remove('active');
  document.getElementById('page-title').textContent='ÅirkÉ™tlÉ™r';
}

// â”€â”€ MODAL â”€â”€
function openAddModal(){document.getElementById('modal-add').classList.add('show')}
function closeModal(){document.getElementById('modal-add').classList.remove('show')}

// â”€â”€ SEARCH â”€â”€
function searchCompany(v){
  document.querySelectorAll('#dashboard-table tr').forEach(r=>{
    r.style.display=r.textContent.toLowerCase().includes(v.toLowerCase())?'':'none';
  });
}

// â”€â”€ FILE HANDLE â”€â”€
function handleFile(input, type){
  const f=input.files[0];
  if(!f)return;
  const list=document.getElementById('list-'+type);
  const item=document.createElement('div');
  item.className='file-item';
  item.innerHTML=`<span class="fi-icon">ğŸ“Š</span><span class="fi-name">${f.name}</span><span class="fi-status badge warn">â³ Emal edilir...</span>`;
  list.appendChild(item);
  setTimeout(()=>{item.querySelector('.fi-status').className='fi-status badge ok';item.querySelector('.fi-status').textContent='âœ… Ä°dxal edildi';},1500);
}
function handleDrop(e,type){
  e.preventDefault();e.currentTarget.classList.remove('drag');
  const f=e.dataTransfer.files[0];
  if(f){handleFile({files:[f]},type);}
}

// â”€â”€ EDV PERIOD â”€â”€
const edvData = {
  '12-2025':{cixis:29425.43,dovriyye:163474.59,giris:15858.18,net:13567.25,status:'ok',statusTxt:'âœ… Dekabr 2025 bÉ™yannamÉ™si 18.01.2026 tarixdÉ™ vaxtÄ±nda tÉ™qdim edilmiÅŸdir.'},
  '01-2026':{cixis:0,dovriyye:0,giris:29162.33,net:0,status:'warn',statusTxt:'ğŸ”„ Yanvar 2026 bÉ™yannamÉ™si hazÄ±rlanÄ±r. Son tarix: 20 Fevral 2026.'},
  '02-2026':{cixis:0,dovriyye:0,giris:0,net:0,status:'info',statusTxt:'ğŸ“Œ Fevral 2026 bÉ™yannamÉ™si hÉ™lÉ™ baÅŸlanmamÄ±ÅŸdÄ±r. Son tarix: 20 Mart 2026.'}
};
function edvPeriodChange(){
  const ay=document.getElementById('edv-ay').value;
  const d=edvData[ay];
  document.getElementById('vf-cixis').textContent=fmt(d.cixis)+' â‚¼';
  document.getElementById('vf-dovriyye').textContent='DÃ¶vriyyÉ™: '+fmt(d.dovriyye)+' â‚¼';
  document.getElementById('vf-giris').textContent=fmt(d.giris)+' â‚¼';
  document.getElementById('vf-net').textContent=fmt(d.net)+' â‚¼';
  document.getElementById('vf-net-sub').textContent=d.net>0?'BÃ¼dcÉ™yÉ™ Ã¶dÉ™nilib':'HesablanÄ±r...';
  const al=document.getElementById('edv-status-alert');
  al.className='alert '+(d.status==='ok'?'ok':d.status==='warn'?'warn':'info');
  al.textContent=d.statusTxt;
}
function fmt(n){return Number(n).toLocaleString('az',{minimumFractionDigits:2,maximumFractionDigits:2})}

// â”€â”€ EDV HESABLA (yekun) â”€â”€
function edvHesabla(){
  let k1=0,k2=0,k3=0;
  // kat1
  document.querySelectorAll('#tbody-kat1 tr').forEach(r=>{
    const cells=r.querySelectorAll('td');
    if(cells.length>=7){const v=parseFloat((cells[6].textContent||'').replace(/[^\d.]/g,''));if(!isNaN(v))k1+=v;}
  });
  // kat2
  document.querySelectorAll('#tbody-kat2 tr').forEach(r=>{
    const cells=r.querySelectorAll('td');
    if(cells.length>=6){const v=parseFloat((cells[5].textContent||'').replace(/[^\d.]/g,''));if(!isNaN(v))k2+=v;}
  });
  // kat3
  document.querySelectorAll('#tbody-kat3 tr').forEach(r=>{
    const cells=r.querySelectorAll('td');
    if(cells.length>=7){const v=parseFloat((cells[6].textContent||'').replace(/[^\d.]/g,''));if(!isNaN(v))k3+=v;}
  });
  const total=k1+k2+k3;
  document.getElementById('yekun-kat1').textContent=fmt(k1);
  document.getElementById('yekun-kat2').textContent=fmt(k2);
  document.getElementById('yekun-kat3').textContent=fmt(k3);
  document.getElementById('yekun-total').textContent=fmt(total)+' â‚¼';
  document.getElementById('kat1-toplam').textContent=fmt(k1)+' â‚¼';
  document.getElementById('kat2-toplam').textContent=fmt(k2)+' â‚¼';
  document.getElementById('kat3-toplam').textContent=fmt(k3)+' â‚¼';
  document.getElementById('kat1-cem').textContent=fmt(k1)+' â‚¼';
  document.getElementById('kat2-cem').textContent=fmt(k2)+' â‚¼';
  document.getElementById('kat3-cem').textContent=fmt(k3)+' â‚¼';
  if(total>0){
    document.getElementById('yekun-kat1-pct').textContent=(k1/total*100).toFixed(1)+'%';
    document.getElementById('yekun-kat2-pct').textContent=(k2/total*100).toFixed(1)+'%';
    document.getElementById('yekun-kat3-pct').textContent=(k3/total*100).toFixed(1)+'%';
  }
  document.getElementById('vf-giris').textContent=fmt(total)+' â‚¼';
  document.getElementById('vf-giris-sub').textContent='3 mÉ™nbÉ™: '+fmt(k1)+' + '+fmt(k2)+' + '+fmt(k3);
  const ay=document.getElementById('edv-ay').value;
  const d=edvData[ay];
  const net=d.cixis-total;
  document.getElementById('vf-net').textContent=fmt(Math.max(0,net))+' â‚¼';
  document.getElementById('vf-net-sub').textContent=net>0?'Ã–dÉ™nilmÉ™li':'QaytarÄ±lmalÄ±: '+fmt(Math.abs(net))+' â‚¼';
}

// â”€â”€ IMPORT: ÆDV DEPOZÄ°T (KAT1) â”€â”€
function importEdvDeposit(input){
  const f=input.files[0];if(!f)return;
  const reader=new FileReader();
  reader.onload=function(e){
    try{
      const wb=XLSX.read(e.target.result,{type:'array'});
      const ws=wb.Sheets[wb.SheetNames[0]];
      const data=XLSX.utils.sheet_to_json(ws,{header:1,defval:''});
      const tbody=document.getElementById('tbody-kat1');
      tbody.innerHTML='';
      let rowNum=0;
      data.forEach(row=>{
        // Find data rows: first cell should be a number
        const sira=parseFloat(row[0]);
        if(isNaN(sira)||sira<1)return;
        const mexaric=parseFloat(String(row[6]||'').replace(',','.'));
        if(isNaN(mexaric)||mexaric<=0)return;
        rowNum++;
        const teyin=String(row[10]||'');
        // Extract EQF from description
        const eqfMatch=teyin.match(/(MT\d{4})\s*(\d{7,})/);
        const seriya=row[11]||eqfMatch?.[1]||'â€”';
        const nomre=row[12]||eqfMatch?.[2]||'â€”';
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td>${rowNum}</td>
          <td>${row[4]||'â€”'}</td>
          <td contenteditable="true">${String(row[2]||'').substring(0,35)}</td>
          <td>${row[1]||'â€”'}</td>
          <td>${seriya}</td>
          <td>${nomre}</td>
          <td class="num" contenteditable="true">${mexaric.toFixed(2)}</td>
          <td>${row[13]||'114111'}</td>
          <td><span class="badge ok">âœ… Ã–dÉ™nildi</span></td>
          <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer">ğŸ—‘</button></td>`;
        tbody.appendChild(tr);
      });
      if(rowNum===0){tbody.innerHTML='<tr><td colspan="10" style="color:var(--muted);text-align:center;padding:16px">UyÄŸun mÉ™lumat tapÄ±lmadÄ±. Format: â„–, VÃ–EN, Ad, Tarix, MÉ™daxil, MÉ™xaric...</td></tr>';return;}
      recalcKat1();edvHesabla();
      showToast('âœ… '+rowNum+' sÉ™tir idxal edildi (ÆDV Depozit)');
    }catch(err){showToast('âŒ Fayl oxunmadÄ±: '+err.message,'err');}
  };
  reader.readAsArrayBuffer(f);
}

// â”€â”€ IMPORT: Ä°DXAL ÆDV (KAT3) â”€â”€
function importIdxal(input){
  const f=input.files[0];if(!f)return;
  const reader=new FileReader();
  reader.onload=function(e){
    try{
      const wb=XLSX.read(e.target.result,{type:'array'});
      const ws=wb.Sheets[wb.SheetNames[0]];
      const data=XLSX.utils.sheet_to_json(ws,{header:1,defval:''});
      const tbody=document.getElementById('tbody-kat3');
      tbody.innerHTML='';
      let rowNum=0;
      data.forEach((row,i)=>{
        if(i<1)return;
        const edv=parseFloat(String(row[6]||row[5]||'').replace(',','.'));
        if(isNaN(edv)||edv<=0)return;
        rowNum++;
        const tr=document.createElement('tr');
        tr.innerHTML=`
          <td>${rowNum}</td>
          <td contenteditable="true">${row[0]||'â€”'}</td>
          <td contenteditable="true">${row[1]||'â€”'}</td>
          <td contenteditable="true">${row[2]||'â€”'}</td>
          <td contenteditable="true">${row[3]||'â€”'}</td>
          <td class="num" contenteditable="true">${parseFloat(row[5]||0).toFixed(2)}</td>
          <td class="num" contenteditable="true">${edv.toFixed(2)}</td>
          <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer">ğŸ—‘</button></td>`;
        tbody.appendChild(tr);
      });
      if(rowNum===0){showToast('âŒ UyÄŸun sÉ™tir tapÄ±lmadÄ±','err');return;}
      edvHesabla();
      showToast('âœ… '+rowNum+' idxal É™mÉ™liyyatÄ± yÃ¼klÉ™ndi');
    }catch(err){showToast('âŒ '+err.message,'err');}
  };
  reader.readAsArrayBuffer(f);
}

// â”€â”€ IMPORT: KASSA ÅÆKÄ°LLÆRÄ° â”€â”€
function importKassaImages(input){
  const files=Array.from(input.files);
  const container=document.getElementById('kassa-images');
  files.forEach((f,idx)=>{
    const url=URL.createObjectURL(f);
    const div=document.createElement('div');
    div.style.cssText='position:relative;border:1px solid var(--border);border-radius:8px;overflow:hidden;width:120px';
    div.innerHTML=`<img src="${url}" style="width:100%;height:80px;object-fit:cover;display:block">
      <div style="padding:4px 6px;font-size:.65rem;color:var(--muted)">${f.name.substring(0,14)}</div>`;
    container.appendChild(div);
    // Simulate OCR reading
    setTimeout(()=>{
      addKassaFromOcr(idx+1, f.name);
    },800+idx*300);
  });
}
function addKassaFromOcr(num, fname){
  const tbody=document.getElementById('tbody-kat2');
  // Remove placeholder
  tbody.querySelectorAll('tr').forEach(r=>{if(r.children.length===1)r.remove();});
  const amount=(Math.random()*200+50).toFixed(2);
  const edv=(amount*18/118).toFixed(2);
  const tr=document.createElement('tr');
  tr.innerHTML=`
    <td>${num}</td>
    <td contenteditable="true">${new Date().toLocaleDateString('az')}</td>
    <td contenteditable="true">NKA Ã§eki â€” ${fname.substring(0,12)}</td>
    <td contenteditable="true">â€”</td>
    <td class="num" contenteditable="true">${amount}</td>
    <td class="num" contenteditable="true">${edv}</td>
    <td><span class="badge warn">ğŸ“· OCR</span></td>
    <td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer">ğŸ—‘</button></td>`;
  tbody.appendChild(tr);
  edvHesabla();
  showToast('ğŸ“· Ã‡ek oxundu, zÉ™hmÉ™t olmasa mÉ™lumatlarÄ± yoxlayÄ±n');
}

// â”€â”€ SATIR ÆLAVÆ ET â”€â”€
function addKat1Row(){
  const tbody=document.getElementById('tbody-kat1');
  const n=tbody.querySelectorAll('tr').length+1;
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${n}</td><td contenteditable="true">__-__-____</td><td contenteditable="true">ÅirkÉ™t adÄ±</td><td contenteditable="true">VÃ–EN</td><td contenteditable="true">MT____</td><td contenteditable="true">0</td><td class="num" contenteditable="true">0.00</td><td>114111</td><td><span class="badge warn">âœï¸ Yeni</span></td><td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer">ğŸ—‘</button></td>`;
  tbody.appendChild(tr);
}
function addKat2Row(){
  const tbody=document.getElementById('tbody-kat2');
  tbody.querySelectorAll('tr').forEach(r=>{if(r.children.length===1)r.remove();});
  const n=tbody.querySelectorAll('tr').length+1;
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${n}</td><td contenteditable="true">__-__-____</td><td contenteditable="true">SatÄ±cÄ± adÄ±</td><td contenteditable="true">â€”</td><td class="num" contenteditable="true">0.00</td><td class="num" contenteditable="true">0.00</td><td><span class="badge warn">âœï¸ Yeni</span></td><td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer">ğŸ—‘</button></td>`;
  tbody.appendChild(tr);
}
function addKat3Row(){
  const tbody=document.getElementById('tbody-kat3');
  tbody.querySelectorAll('tr').forEach(r=>{if(r.children.length===1)r.remove();});
  const n=tbody.querySelectorAll('tr').length+1;
  const tr=document.createElement('tr');
  tr.innerHTML=`<td>${n}</td><td contenteditable="true">__-__-____</td><td contenteditable="true">BÉ™yannamÉ™ â„–</td><td contenteditable="true">Mal adÄ±</td><td contenteditable="true">â€”</td><td class="num" contenteditable="true">0.00</td><td class="num" contenteditable="true">0.00</td><td><button onclick="deleteRow(this)" style="background:none;border:none;color:var(--red);cursor:pointer">ğŸ—‘</button></td>`;
  tbody.appendChild(tr);
}
function deleteRow(btn){btn.closest('tr').remove();edvHesabla();}
function recalcKat1(){edvHesabla();}

// â”€â”€ DOWNLOAD AVAZ â”€â”€
function downloadAvaz(){downloadAvazFull();}
function downloadAvazFull(){
  if(typeof XLSX==='undefined'){alert('XLSX kitabxanasÄ± yÃ¼klÉ™nmir');return;}
  const wb=XLSX.utils.book_new();
  const rows=[];
  document.querySelectorAll('#tbody-kat1 tr').forEach(r=>{
    const cells=r.querySelectorAll('td');
    if(cells.length<7)return;
    const seriya=cells[4].textContent.trim();
    const nomre=cells[5].textContent.trim();
    const mebleg=parseFloat((cells[6].textContent||'').replace(/[^\d.]/g,''));
    if(seriya==='â€”'||isNaN(mebleg)||mebleg===0)return;
    rows.push([308,seriya,nomre,mebleg]);
  });
  const ws=XLSX.utils.aoa_to_sheet(rows);
  XLSX.utils.book_append_sheet(wb,ws,'Avazlesdirme');
  XLSX.writeFile(wb,'avazlesdirme_'+document.getElementById('edv-ay').value.replace('-','_')+'.xlsx');
}
function downloadEdvExcel(){
  if(typeof XLSX==='undefined')return;
  const wb=XLSX.utils.book_new();
  const ay=document.getElementById('edv-ay').value;
  const d=edvData[ay];
  const data=[
    ['ÆDV HesabatÄ±','',''],['ÅirkÉ™t','"3V" MMC',''],['VÃ–EN','2302351311',''],['DÃ¶vr',ay,''],['','',''],
    ['GÃ¶stÉ™rici','AÃ§Ä±qlama','MÉ™blÉ™ÄŸ (â‚¼)'],
    ['1001','Ãœmumi vergi tutulan dÃ¶vriyyÉ™',d.dovriyye],
    ['1101','HesablanmÄ±ÅŸ ÆDV (Ã§Ä±xÄ±ÅŸ)',d.cixis],
    ['1016','ÆvÉ™zlÉ™ÅŸdirilÉ™n ÆDV (giriÅŸ)',parseFloat(document.getElementById('yekun-total').textContent)||d.giris],
    ['1023','Ã–dÉ™nilmÉ™li ÆDV',d.net],
  ];
  const ws=XLSX.utils.aoa_to_sheet(data);
  XLSX.utils.book_append_sheet(wb,ws,'EDV_Hesabat');
  XLSX.writeFile(wb,'edv_hesabat_'+ay.replace('-','_')+'.xlsx');
}

// â”€â”€ TOAST â”€â”€
function showToast(msg,type='ok'){
  const t=document.createElement('div');
  t.textContent=msg;
  t.style.cssText=`position:fixed;bottom:24px;right:24px;background:${type==='err'?'var(--red)':'var(--accent2)'};color:#fff;padding:12px 20px;border-radius:10px;font-size:.82rem;z-index:999;box-shadow:0 4px 20px rgba(0,0,0,.4);transition:opacity .4s`;
  document.body.appendChild(t);
  setTimeout(()=>{t.style.opacity='0';setTimeout(()=>t.remove(),400);},3000);
}

// â”€â”€ CHARTS â”€â”€
window.addEventListener('load', ()=>{
  // Bank chart in dashboard
  const ctx=document.getElementById('bankChart').getContext('2d');
  new Chart(ctx,{type:'line',data:{
    labels:['Dek 2025','Yan 2026','Fev 2026'],
    datasets:[
      {label:'AIIB Kredit',data:[320000,180000,46573],borderColor:'#10b981',backgroundColor:'rgba(16,185,129,.1)',tension:.4,fill:true},
      {label:'AIIB Debit',data:[325000,178000,46004],borderColor:'#ef4444',backgroundColor:'rgba(239,68,68,.05)',tension:.4},
      {label:'Ä°BAZ Kredit',data:[190000,157071,0],borderColor:'#6366f1',backgroundColor:'rgba(99,102,241,.1)',tension:.4},
    ]
  },options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{labels:{color:'#8888aa',font:{size:11}}}},scales:{x:{ticks:{color:'#64748b'}},y:{ticks:{color:'#64748b',callback:v=>(v/1000).toFixed(0)+'K â‚¼'}}}}});
});

function initBankCharts(){
  if(window._bankChartsInit)return;
  window._bankChartsInit=true;

  // AIIB donut
  const a=document.getElementById('aiibChart').getContext('2d');
  new Chart(a,{type:'doughnut',data:{
    labels:['POS Terminal','KÃ¶Ã§Ã¼rmÉ™','DigÉ™r'],
    datasets:[{data:[282896,200000,66108],backgroundColor:['#6366f1','#10b981','#f59e0b'],borderWidth:0}]
  },options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{position:'right',labels:{color:'#8888aa',font:{size:11}}}}}});

  // IBAZ bar
  const b=document.getElementById('ibazChart').getContext('2d');
  new Chart(b,{type:'bar',data:{
    labels:['USD alÄ±ÅŸÄ±','PAHA','AIIB kÃ¶Ã§Ã¼rmÉ™si','ÆmÉ™k haqqÄ±','Borc (gÉ™lir)','DigÉ™r'],
    datasets:[{label:'â‚¼',data:[133450,36468,25375,12274,-68000,207377],backgroundColor:['#ef4444','#f59e0b','#6366f1','#8b5cf6','#10b981','#64748b']}]
  },options:{responsive:true,maintainAspectRatio:false,plugins:{legend:{display:false}},scales:{x:{ticks:{color:'#64748b',font:{size:10}}},y:{ticks:{color:'#64748b',callback:v=>v.toLocaleString()+'â‚¼'}}}}});
}
</script>
</body>
</html>
